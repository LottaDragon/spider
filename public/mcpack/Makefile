###########################################################################
# Automatically generated by comake (1.0.0)  							  #
###########################################################################

#################设计系统参数#######################################
WORKROOT	?=	../../
IDLCC	:=	$(WORKROOT)/public/idlcompiler/output/bin/mcy
CC	:=	gcc
CXX	:=	g++
LEX	:=	flex
YACC	:= yacc
CFLAGS	:=	-pipe -Wall -W -g -fPIC -Werror -O2
CXXFLAGS	:=	-pipe -Wall -W -g -fPIC -Werror -O2
LEXFLAGS	:=	
YACCFLAGS	:=	
LINKFLAGS	:=  -rdynamic
LINK	:=	g++
AR	:=	ar cqs
RANLIB	:=	
COMAKE	:=	comake

###############baidu lib 的32位 64位支持#################
ifeq ($(MAC), 64)
	lib2=lib2-64
	third=third-64
else
	lib2=lib2
	third=third
endif
##########################################

# 编译参数
DEP_INCPATH = 
DEP_LDFLAGS = 
DEP_LDLIBS = 
INCPATH =  -I./include
MAKDEP = Makefile.dep


#start target
first : all

############# 默认推到公式
.SUFFIXES: .c .cpp .cc .cxx .C .idl .des

.cpp.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.cc.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.cxx.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.C.o:
	$(CXX) -c -o $@ $<  $(CXXFLAGS) $(CPPFLAGS) $(INCPATH)

.c.o:
	$(CC) -c -o $@ $<  $(CFLAGS) $(CPPFLAGS) $(INCPATH)

.idl.cpp:
	$(IDLCC) --ns=$(*F) -o $* $< $(CPPFLAGS) $(INCPATH)

#############
###cpp 支持
%info : %
	ccp $<
#############


#__$MAKEFILE_RULES$__


###############编译目标
all :  target output 
.PHONY : all clean test output comake src conf 

target : libmcpack.a 

test : 	./unittest_test_mcpack1		./unittest_test_mcpack2	
	./unittest_test_mcpack1
	./unittest_test_mcpack2


comake :
	-make clean
	-comake 

#-include $(MAKDEP)
-include $(MAKDEP)

#----------------build target : libmcpack.a--------------------

libmcpack.a : CC := gcc
libmcpack.a : CXX := g++
libmcpack.a : CXXFLAGS := -pipe -Wall -W -g -fPIC -Werror -O2
libmcpack.a : CPPFLAGS := -D_GNU_SOURCE
libmcpack.a : CFLAGS := -pipe -Wall -W -g -fPIC -Werror -O2
libmcpack.a : INCPATH :=  -I./include $(DEP_INCPATH)
libmcpack.a : LDLIBS := -lm -lpthread $(DEP_LDLIBS)
libmcpack.a : LDFLAGS :=  $(DEP_LDFLAGS)
libmcpack.a : LINKFLAGS := -rdynamic

libmcpack_a_SOURCES := $(wildcard comake_autogen.cpp src/mc_pack.cpp src/mc_pack1.cpp src/mc_pack2.cpp src/mc_pack_cpp.cpp src/mc_pack_ex.c src/mc_pack_core.c src/mc_pack_json.c src/mc_pack_text.c)
#libmcpack_a_HEADERS := $(wildcard include/*.h)
libmcpack_a_HEADERS := include/*.h
libmcpack_a_IDLSRC := $(wildcard __$IDLSRC_VALUE$__)
libmcpack_a_IDLSRCCPP := $(patsubst %.idl,%.cpp, $(libmcpack_a_IDLSRC))
libmcpack_a_IDLSRCH := $(patsubst %.idl,%.h, $(libmcpack_a_IDLSRC))
libmcpack_a_CONFDES := $(wildcard __$CONFDES$_VALUE$__ libmcpack.a.des)
libmcpack_a_CONFRANGE := $(patsubst %.des,%.range, $(libmcpack_a_CONFDES))
libmcpack_a_OBJS := $(libmcpack_a_IDLSRC:.idl=.o)
libmcpack_a_OBJS += $(libmcpack_a_SOURCES:.c=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.cc=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.cpp=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.cxx=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.C=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.idl=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.yacc=.o)
libmcpack_a_OBJS := $(libmcpack_a_OBJS:.lex=.o)
libmcpack.a : $(libmcpack_a_OBJS) 
	rm -f $@ || echo 
	ar cr $@ $^


define libmcpack_a_output
	mkdir -p output
	-mkdir -p output/lib
	-cp -rf libmcpack.a output/lib
	-mkdir -p output/include
	-cp -rf $(libmcpack_a_HEADERS) output/include
endef
	

define libmcpack_a_clean
	-rm -rf $(libmcpack_a_OBJS) $(libmcpack_a_IDLSRCCPP) $(libmcpack_a_IDLSRCH) libmcpack.a.range conf/libmcpack.a.range
	-rm -rf libmcpack.a
	-rm -rf output
	-rm -rf ccp_output.error   ccp_output_scm.xml  ccp_output.xml ccp_output.pclint  ccp_output.txt
endef
	

define libmcpack_a_ccpc
	ccp $(libmcpack_a_SOURCES) --formatter vim
endef
	

define libmcpack_a_cov
	
endef
	



#---------------------end build target : libmcpack.a------------------

#----------------build target : unittest_test_mcpack1--------------------

unittest_test_mcpack1 : CC := gcc
unittest_test_mcpack1 : CXX := g++
unittest_test_mcpack1 : CXXFLAGS := -pipe -Wall -W -g -fPIC -Werror -O2
unittest_test_mcpack1 : CPPFLAGS := -D_GNU_SOURCE
unittest_test_mcpack1 : CFLAGS := -pipe -Wall -W -g -fPIC -Werror -O2
unittest_test_mcpack1 : INCPATH :=  -I./include $(DEP_INCPATH)
unittest_test_mcpack1 : LDLIBS := -lm -lpthread $(DEP_LDLIBS)
unittest_test_mcpack1 : LDFLAGS :=  $(DEP_LDFLAGS)
unittest_test_mcpack1 : LINKFLAGS := -rdynamic

unittest_test_mcpack1_SOURCES := $(wildcard comake_autogen.cpp src/mc_pack.cpp src/mc_pack1.cpp src/mc_pack2.cpp src/mc_pack_cpp.cpp src/mc_pack_ex.c src/mc_pack_core.c src/mc_pack_json.c src/mc_pack_text.c)
#unittest_test_mcpack1_HEADERS := $(wildcard include/*.h)
unittest_test_mcpack1_HEADERS := include/*.h
unittest_test_mcpack1_IDLSRC := $(wildcard __$IDLSRC_VALUE$__)
unittest_test_mcpack1_IDLSRCCPP := $(patsubst %.idl,%.cpp, $(unittest_test_mcpack1_IDLSRC))
unittest_test_mcpack1_IDLSRCH := $(patsubst %.idl,%.h, $(unittest_test_mcpack1_IDLSRC))
unittest_test_mcpack1_CONFDES := $(wildcard __$CONFDES$_VALUE$__ unittest_test_mcpack1.des)
unittest_test_mcpack1_CONFRANGE := $(patsubst %.des,%.range, $(unittest_test_mcpack1_CONFDES))
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_IDLSRC:.idl=.o)
unittest_test_mcpack1_OBJS += $(unittest_test_mcpack1_SOURCES:.c=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.cc=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.cpp=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.cxx=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.C=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.idl=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.yacc=.o)
unittest_test_mcpack1_OBJS := $(unittest_test_mcpack1_OBJS:.lex=.o)
unittest_test_mcpack1 : $(unittest_test_mcpack1_OBJS) 
	@`for x in $(unittest_test_mcpack1_CONFDES);do cpp -C -o unittest_test_mcpack1.range $$x $(CPPFLAGS) $(INCPATH);mkdir -p conf;cp unittest_test_mcpack1.range conf/; done`
	$(LINK) $^ -o $@ -Xlinker "-(" $(LDFLAGS) $(LDLIBS) $(LINKFLAGS) -Xlinker "-)"


define unittest_test_mcpack1_output
	
endef
	

define unittest_test_mcpack1_clean
	-rm -rf $(unittest_test_mcpack1_OBJS) $(unittest_test_mcpack1_IDLSRCCPP) $(unittest_test_mcpack1_IDLSRCH) unittest_test_mcpack1.range conf/unittest_test_mcpack1.range
	-rm -rf unittest_test_mcpack1
	-rm -rf output
	-rm -rf ccp_output.error   ccp_output_scm.xml  ccp_output.xml ccp_output.pclint  ccp_output.txt
endef
	

define unittest_test_mcpack1_ccpc
	ccp $(unittest_test_mcpack1_SOURCES) --formatter vim
endef
	

define unittest_test_mcpack1_cov
	
endef
	



#---------------------end build target : unittest_test_mcpack1------------------

#----------------build target : unittest_test_mcpack2--------------------

unittest_test_mcpack2 : CC := gcc
unittest_test_mcpack2 : CXX := g++
unittest_test_mcpack2 : CXXFLAGS := -pipe -Wall -W -g -fPIC -Werror -O2
unittest_test_mcpack2 : CPPFLAGS := -D_GNU_SOURCE
unittest_test_mcpack2 : CFLAGS := -pipe -Wall -W -g -fPIC -Werror -O2
unittest_test_mcpack2 : INCPATH :=  -I./include $(DEP_INCPATH)
unittest_test_mcpack2 : LDLIBS := -lm -lpthread $(DEP_LDLIBS)
unittest_test_mcpack2 : LDFLAGS :=  $(DEP_LDFLAGS)
unittest_test_mcpack2 : LINKFLAGS := -rdynamic

unittest_test_mcpack2_SOURCES := $(wildcard comake_autogen.cpp src/mc_pack.cpp src/mc_pack1.cpp src/mc_pack2.cpp src/mc_pack_cpp.cpp src/mc_pack_ex.c src/mc_pack_core.c src/mc_pack_json.c src/mc_pack_text.c)
#unittest_test_mcpack2_HEADERS := $(wildcard include/*.h)
unittest_test_mcpack2_HEADERS := include/*.h
unittest_test_mcpack2_IDLSRC := $(wildcard __$IDLSRC_VALUE$__)
unittest_test_mcpack2_IDLSRCCPP := $(patsubst %.idl,%.cpp, $(unittest_test_mcpack2_IDLSRC))
unittest_test_mcpack2_IDLSRCH := $(patsubst %.idl,%.h, $(unittest_test_mcpack2_IDLSRC))
unittest_test_mcpack2_CONFDES := $(wildcard __$CONFDES$_VALUE$__ unittest_test_mcpack2.des)
unittest_test_mcpack2_CONFRANGE := $(patsubst %.des,%.range, $(unittest_test_mcpack2_CONFDES))
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_IDLSRC:.idl=.o)
unittest_test_mcpack2_OBJS += $(unittest_test_mcpack2_SOURCES:.c=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.cc=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.cpp=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.cxx=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.C=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.idl=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.yacc=.o)
unittest_test_mcpack2_OBJS := $(unittest_test_mcpack2_OBJS:.lex=.o)
unittest_test_mcpack2 : $(unittest_test_mcpack2_OBJS) 
	@`for x in $(unittest_test_mcpack2_CONFDES);do cpp -C -o unittest_test_mcpack2.range $$x $(CPPFLAGS) $(INCPATH);mkdir -p conf;cp unittest_test_mcpack2.range conf/; done`
	$(LINK) $^ -o $@ -Xlinker "-(" $(LDFLAGS) $(LDLIBS) $(LINKFLAGS) -Xlinker "-)"


define unittest_test_mcpack2_output
	
endef
	

define unittest_test_mcpack2_clean
	-rm -rf $(unittest_test_mcpack2_OBJS) $(unittest_test_mcpack2_IDLSRCCPP) $(unittest_test_mcpack2_IDLSRCH) unittest_test_mcpack2.range conf/unittest_test_mcpack2.range
	-rm -rf unittest_test_mcpack2
	-rm -rf output
	-rm -rf ccp_output.error   ccp_output_scm.xml  ccp_output.xml ccp_output.pclint  ccp_output.txt
endef
	

define unittest_test_mcpack2_ccpc
	ccp $(unittest_test_mcpack2_SOURCES) --formatter vim
endef
	

define unittest_test_mcpack2_cov
	
endef
	



#---------------------end build target : unittest_test_mcpack2------------------

debug : 
	make -f Makefile.debug

define _output
	$(libmcpack_a_output)
	$(unittest_test_mcpack1_output)
	$(unittest_test_mcpack2_output)
endef
	

define _clean
	$(libmcpack_a_clean)
	$(unittest_test_mcpack1_clean)
	$(unittest_test_mcpack2_clean)
endef
	

ccpc : 
	$(libmcpack_a_ccpc)
	$(unittest_test_mcpack1_ccpc)
	$(unittest_test_mcpack2_ccpc)

cov : 
	cov01 -1
	make clean
	make 
	cov01 -0



output : libmcpack.a 
	$(_output)
	rm -rf $(MAKDEP)

$(MAKDEP) : $(wildcard comake_autogen.cpp src/mc_pack.cpp src/mc_pack1.cpp src/mc_pack2.cpp src/mc_pack_cpp.cpp src/mc_pack_ex.c src/mc_pack_core.c src/mc_pack_json.c src/mc_pack_text.c)
	-$(CC) -MG -MM $(CPPFLAGS) $(INCPATH) $(DEP_INCPATH) $^ > $@

clean:
	$(_clean)
	rm -rf $(MAKDEP)


